-- Retrieve VMware events count from the last 90 days
SELECT 
    Count(CASE WHEN logs.LogEntryTypeID = 5 THEN logs.LogEntryID END) AS [VMware Events in 90 days]   -- Column: Count of VMware events (LogEntryTypeID = 5)

FROM 
    Orion.OLM.LogEntry AS logs

JOIN 
    Orion.OLM.LogEntryType AS type ON type.LogEntryTypeID = logs.LogEntryTypeID  -- Join with LogEntryType to get event type details

WHERE 
    logs.LogEntryTypeID IN (5)  -- Filter for VMware (5) events
    AND logs.DateTime > ADDDATE('day', -90, GETUTCDATE());  -- Filter events from the last 90 days